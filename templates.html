<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VOM Template Generator - Vendor of the Month</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Montserrat:wght@300;400;600;700;900&family=Dancing+Script:wght@700&family=Bebas+Neue&family=Oswald:wght@400;600;700&family=Raleway:wght@300;400;600;700&family=Cormorant+Garamond:wght@400;600;700&family=Permanent+Marker&family=Anton&family=Abril+Fatface&family=Lobster&family=Poppins:wght@300;400;600;700&family=Lato:wght@300;400;700&family=Roboto+Slab:wght@400;700&family=Merriweather:wght@400;700&family=Pacifico&family=Sacramento&family=Great+Vibes&family=Righteous&family=Cinzel:wght@400;700;900&family=Archivo+Black&family=Josefin+Sans:wght@300;400;600;700&family=Caveat:wght@400;700&family=Satisfy&family=Comfortaa:wght@300;400;700&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: #1a1a2e;
            color: #fff;
            font-family: 'Montserrat', sans-serif;
            padding: 40px 20px;
        }

        h1 {
            text-align: center;
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #f093fb, #f5576c, #4facfe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle { text-align: center; color: #888; margin-bottom: 15px; font-size: 1.1rem; }

        .theme-badge { text-align: center; margin-bottom: 40px; }
        .theme-badge span {
            display: inline-block; padding: 8px 24px; border-radius: 30px;
            font-size: 0.9rem; font-weight: 600; letter-spacing: 1px;
        }

        /* Controls */
        .controls {
            max-width: 900px; margin: 0 auto 50px;
            background: #16213e; border-radius: 16px; padding: 30px;
        }
        .controls h2 { font-family: 'Playfair Display', serif; font-size: 1.4rem; margin-bottom: 15px; color: #4facfe; }
        .controls-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        .control-group label { display: block; font-size: 0.85rem; color: #aaa; margin-bottom: 6px; }
        .control-group input, .control-group select {
            width: 100%; padding: 10px 14px; border: 1px solid #333; border-radius: 8px;
            background: #0f3460; color: #fff; font-size: 1rem; font-family: 'Montserrat', sans-serif;
        }
        .control-group input:focus, .control-group select:focus { outline: none; border-color: #4facfe; }
        .control-group select option { background: #0f3460; }

        .vendors-section { margin-top: 20px; border-top: 1px solid #2a2a4a; padding-top: 20px; }
        .vendors-section h3 { font-size: 1rem; color: #4facfe; margin-bottom: 12px; }
        .vendor-row { display: grid; grid-template-columns: 1fr 1fr 1fr auto; gap: 12px; align-items: end; margin-bottom: 10px; }
        .btn-remove { padding: 10px 14px; background: #e74c3c; border: none; border-radius: 8px; color: #fff; cursor: pointer; font-size: 1rem; }
        .btn-remove:hover { background: #c0392b; }
        .btn-add { padding: 10px 20px; background: linear-gradient(135deg, #2ecc71, #27ae60); border: none; border-radius: 8px; color: #fff; font-weight: 600; font-size: 0.9rem; cursor: pointer; margin-top: 10px; }
        .btn-update { width: 100%; margin-top: 20px; padding: 14px; background: linear-gradient(135deg, #4facfe, #00f2fe); border: none; border-radius: 8px; color: #1a1a2e; font-weight: 700; font-size: 1rem; cursor: pointer; }

        /* Grid */
        .templates-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 40px; max-width: 1400px; margin: 0 auto;
        }
        .template-wrapper { text-align: center; }
        .template-wrapper > h3 { margin-bottom: 12px; color: #ccc; font-size: 0.9rem; letter-spacing: 2px; text-transform: uppercase; }
        .template-card {
            border-radius: 12px; overflow: hidden; box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            transition: transform 0.3s; cursor: pointer; position: relative;
        }
        .template-card:hover { transform: translateY(-8px); }
        .select-badge {
            position: absolute; top: 15px; right: 15px; background: rgba(0,0,0,0.6);
            color: #fff; padding: 6px 14px; border-radius: 20px; font-size: 0.75rem;
            opacity: 0; transition: opacity 0.3s; z-index: 10;
        }
        .template-card:hover .select-badge { opacity: 1; }

        .footer { text-align: center; margin-top: 60px; color: #555; font-size: 0.85rem; }
    </style>
</head>
<body>

    <h1>Vendor of the Month</h1>
    <p class="subtitle">Template Generator â€” Pick a style, customize, and print or share</p>
    <div class="theme-badge"><span id="themeBadge"></span></div>

    <div class="controls">
        <h2>Customize Your Flyer</h2>
        <div class="controls-grid">
            <div class="control-group">
                <label>Month</label>
                <select id="monthName">
                    <option>January</option><option>February</option><option>March</option>
                    <option selected>April</option><option>May</option><option>June</option>
                    <option>July</option><option>August</option><option>September</option>
                    <option>October</option><option>November</option><option>December</option>
                </select>
            </div>
            <div class="control-group">
                <label>Discount</label>
                <input type="text" id="promoPrice" value="20% OFF" placeholder="e.g. 15% OFF">
            </div>
            <div class="control-group" style="grid-column: 1 / -1;">
                <label>Location</label>
                <select id="locationSelect">
                    <option value="all">All Locations</option>
                    <option value="eastside">Olympia Eastside â€” 3044 Pacific Ave SE, Olympia, WA 98501</option>
                    <option value="westside">Olympia Westside â€” 2405 Harrison Ave NW, Olympia, WA 98502</option>
                    <option value="lacey">Lacey â€” 4820 Yelm Hwy SE Ste. D, Lacey, WA 98503</option>
                    <option value="hawks">Hawks Prairie â€” 9323 Martin Way E #101, Olympia, WA 98516</option>
                </select>
            </div>
            <div class="control-group" style="grid-column: 1 / -1;">
                <label>Template Font (applies to headings, deal text, price)</label>
                <select id="templateFont">
                    <option value="" selected>Auto (theme default)</option>
                    <option value="'Playfair Display', serif">Playfair Display</option>
                    <option value="'Montserrat', sans-serif">Montserrat</option>
                    <option value="'Oswald', sans-serif">Oswald</option>
                    <option value="'Bebas Neue', sans-serif">Bebas Neue</option>
                    <option value="'Raleway', sans-serif">Raleway</option>
                    <option value="'Poppins', sans-serif">Poppins</option>
                    <option value="'Lato', sans-serif">Lato</option>
                    <option value="'Josefin Sans', sans-serif">Josefin Sans</option>
                    <option value="'Comfortaa', sans-serif">Comfortaa</option>
                    <option value="'Anton', sans-serif">Anton</option>
                    <option value="'Archivo Black', sans-serif">Archivo Black</option>
                    <option value="'Righteous', sans-serif">Righteous</option>
                    <option value="'Roboto Slab', serif">Roboto Slab</option>
                    <option value="'Merriweather', serif">Merriweather</option>
                    <option value="'Cinzel', serif">Cinzel</option>
                    <option value="'Cormorant Garamond', serif">Cormorant Garamond</option>
                    <option value="'Abril Fatface', serif">Abril Fatface</option>
                    <option value="'Dancing Script', cursive">Dancing Script</option>
                    <option value="'Lobster', cursive">Lobster</option>
                    <option value="'Pacifico', cursive">Pacifico</option>
                    <option value="'Sacramento', cursive">Sacramento</option>
                    <option value="'Great Vibes', cursive">Great Vibes</option>
                    <option value="'Caveat', cursive">Caveat</option>
                    <option value="'Satisfy', cursive">Satisfy</option>
                    <option value="'Permanent Marker', cursive">Permanent Marker</option>
                </select>
            </div>
            <div class="control-group" style="grid-column: 1 / -1;">
                <label>Deal Description</label>
                <input type="text" id="dealDesc" value="Fresh organic produce boxes â€” locally grown, hand-picked daily" placeholder="Describe the deal">
            </div>
            <div class="control-group" style="grid-column: 1 / -1;">
                <label>Custom Image (optional â€” product photo, promo graphic, etc.)</label>
                <div style="display:flex;align-items:center;gap:12px;">
                    <input type="file" id="customImage" accept="image/*" onchange="handleImageUpload(this)" style="flex:1;">
                    <button type="button" onclick="clearCustomImage()" style="padding:8px 16px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);border-radius:8px;color:#fff;font-size:0.8rem;cursor:pointer;">Clear</button>
                </div>
                <div id="imagePreview" style="margin-top:8px;display:none;">
                    <img id="imagePreviewImg" style="max-height:80px;border-radius:6px;border:1px solid rgba(255,255,255,0.15);">
                    <span id="imageFileName" style="margin-left:10px;font-size:0.75rem;color:#aaa;"></span>
                </div>
            </div>
        </div>
        <div class="vendors-section">
            <h3>Vendors</h3>
            <div id="vendorRows">
                <div class="vendor-row">
                    <div class="control-group"><label>Vendor Name</label><input type="text" class="vendor-name-input" value="Spring Valley Farms" placeholder="Vendor name"></div>
                    <div class="control-group"><label>Vendor Deal (optional)</label><input type="text" class="vendor-deal-input" value="Organic Produce" placeholder="Their specialty"></div>
                    <div class="control-group"><label>Vendor Font</label><select class="vendor-font-input"><option value="">Auto</option></select></div>
                    <button class="btn-remove" onclick="removeVendor(this)">âœ•</button>
                </div>
            </div>
            <button class="btn-add" onclick="addVendor()">+ Add Another Vendor</button>
        </div>
        <button class="btn-update" onclick="updateTemplates()">Update All Templates</button>
    </div>

    <div class="templates-grid" id="templatesGrid"></div>
    <div class="footer">
        <p>VOM Template Generator â€” Green Lady Marketing</p>
        <p style="margin-top:8px;color:#666;">8 print flyers + 4 social media posts</p>
    </div>

<script>
// ===== CUSTOM IMAGE =====
let customImageDataURL = '';

function handleImageUpload(input) {
    const file = input.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(e) {
        customImageDataURL = e.target.result;
        document.getElementById('imagePreview').style.display = 'flex';
        document.getElementById('imagePreviewImg').src = customImageDataURL;
        document.getElementById('imageFileName').textContent = file.name;
        updateTemplates();
    };
    reader.readAsDataURL(file);
}

function clearCustomImage() {
    customImageDataURL = '';
    document.getElementById('customImage').value = '';
    document.getElementById('imagePreview').style.display = 'none';
    document.getElementById('imagePreviewImg').src = '';
    document.getElementById('imageFileName').textContent = '';
    updateTemplates();
}

// ===== THEMES =====
const themeData = {
    January:   { label:"â„ï¸ New Year â€” January",      badge:"#e3f2fd", badgeTxt:"#1565c0", emoji1:"â„ï¸ âœ¨ ðŸŽ† âœ¨ â„ï¸", emoji2:"ðŸ¥‚ â„ï¸ ðŸŽ‡ â„ï¸ ðŸ¥‚", c1:"#0d47a1", c2:"#1565c0", c3:"#64b5f6", c4:"#bbdefb", c5:"#e3f2fd", accent:"#ffd54f", dark:"#0a1929" },
    February:  { label:"ðŸ’ Valentine's â€” February",   badge:"#fce4ec", badgeTxt:"#c2185b", emoji1:"ðŸ’• ðŸŒ¹ ðŸ’– ðŸŒ¹ ðŸ’•", emoji2:"ðŸ’ ðŸŒ¹ â¤ï¸ ðŸŒ¹ ðŸ’", c1:"#880e4f", c2:"#c2185b", c3:"#f48fb1", c4:"#f8bbd0", c5:"#fce4ec", accent:"#ffd54f", dark:"#2a0a1a" },
    March:     { label:"â˜˜ï¸ St. Patrick's â€” March",    badge:"#e8f5e9", badgeTxt:"#2e7d32", emoji1:"â˜˜ï¸ ðŸ€ ðŸŒˆ ðŸ€ â˜˜ï¸", emoji2:"ðŸª™ â˜˜ï¸ ðŸ€ â˜˜ï¸ ðŸª™", c1:"#1b5e20", c2:"#2e7d32", c3:"#66bb6a", c4:"#a5d6a7", c5:"#e8f5e9", accent:"#ffd54f", dark:"#0a2e0a" },
    April:     { label:"ðŸŒ¸ Spring â€” April",           badge:"#e8f5e9", badgeTxt:"#2e7d32", emoji1:"ðŸŒ· ðŸŒ¸ ðŸŒ¼ ðŸŒ· ðŸŒ¸", emoji2:"ðŸŒ¿ ðŸŒº ðŸŒ» ðŸŒ¿ ðŸŒº", c1:"#2e7d32", c2:"#4a8c3f", c3:"#81c784", c4:"#c8e6c9", c5:"#e8f5e9", accent:"#e91e63", dark:"#1a2e1a" },
    May:       { label:"ðŸŒº Mother's Day â€” May",       badge:"#fce4ec", badgeTxt:"#ad1457", emoji1:"ðŸŒº ðŸŒ¸ ðŸ’ ðŸŒ¸ ðŸŒº", emoji2:"ðŸŒ· ðŸ’® ðŸŒ¹ ðŸ’® ðŸŒ·", c1:"#880e4f", c2:"#ad1457", c3:"#f06292", c4:"#f8bbd0", c5:"#fce4ec", accent:"#7b1fa2", dark:"#2a0a2a" },
    June:      { label:"â˜€ï¸ Summer â€” June",            badge:"#fff8e1", badgeTxt:"#e65100", emoji1:"â˜€ï¸ ðŸŒ´ ðŸ–ï¸ ðŸŒ´ â˜€ï¸", emoji2:"ðŸŒŠ ðŸš ðŸŒº ðŸš ðŸŒŠ", c1:"#e65100", c2:"#f57c00", c3:"#ffb74d", c4:"#ffe0b2", c5:"#fff8e1", accent:"#0277bd", dark:"#1a1400" },
    July:      { label:"ðŸŽ† 4th of July",              badge:"#e3f2fd", badgeTxt:"#b71c1c", emoji1:"ðŸ‡ºðŸ‡¸ ðŸŽ† â­ ðŸŽ† ðŸ‡ºðŸ‡¸", emoji2:"ðŸŽ‡ â­ ðŸ—½ â­ ðŸŽ‡", c1:"#b71c1c", c2:"#0d47a1", c3:"#ef5350", c4:"#90caf9", c5:"#e3f2fd", accent:"#ffd54f", dark:"#0a0a29" },
    August:    { label:"ðŸ“š Back to School â€” August",  badge:"#fff3e0", badgeTxt:"#e65100", emoji1:"ðŸ“š âœï¸ ðŸŽ’ âœï¸ ðŸ“š", emoji2:"ðŸ“– ðŸŽ ðŸ« ðŸŽ ðŸ“–", c1:"#4e342e", c2:"#e65100", c3:"#ffb74d", c4:"#ffe0b2", c5:"#fff3e0", accent:"#1565c0", dark:"#1a0e0a" },
    September: { label:"ðŸ‚ Fall â€” September",         badge:"#fff3e0", badgeTxt:"#bf360c", emoji1:"ðŸ‚ ðŸ ðŸŒ¾ ðŸ ðŸ‚", emoji2:"ðŸŽƒ ðŸ ðŸ‚ ðŸ ðŸŽƒ", c1:"#bf360c", c2:"#e65100", c3:"#ff8a65", c4:"#ffccbc", c5:"#fbe9e7", accent:"#4e342e", dark:"#1a0a00" },
    October:   { label:"ðŸŽƒ Halloween â€” October",      badge:"#f3e5f5", badgeTxt:"#4a148c", emoji1:"ðŸŽƒ ðŸ‘» ðŸ•¸ï¸ ðŸ‘» ðŸŽƒ", emoji2:"ðŸ¦‡ ðŸ•·ï¸ ðŸ’€ ðŸ•·ï¸ ðŸ¦‡", c1:"#4a148c", c2:"#e65100", c3:"#ff9800", c4:"#ffcc80", c5:"#fff3e0", accent:"#ce93d8", dark:"#0a0520" },
    November:  { label:"ðŸ¦ƒ Thanksgiving â€” November",  badge:"#efebe9", badgeTxt:"#4e342e", emoji1:"ðŸ¦ƒ ðŸ ðŸŒ½ ðŸ ðŸ¦ƒ", emoji2:"ðŸ¥§ ðŸ‚ ðŸŒ¾ ðŸ‚ ðŸ¥§", c1:"#3e2723", c2:"#4e342e", c3:"#8d6e63", c4:"#bcaaa4", c5:"#efebe9", accent:"#bf360c", dark:"#1a0e0a" },
    December:  { label:"ðŸŽ„ Christmas â€” December",     badge:"#ffebee", badgeTxt:"#b71c1c", emoji1:"ðŸŽ„ â­ ðŸŽ… â­ ðŸŽ„", emoji2:"ðŸŽ â„ï¸ ðŸ”” â„ï¸ ðŸŽ", c1:"#b71c1c", c2:"#1b5e20", c3:"#ef5350", c4:"#a5d6a7", c5:"#e8f5e9", accent:"#ffd54f", dark:"#0a1a0a" }
};

const templateNames = [
    "Elegant Framed","Bold Split","Oversized Type","Diagonal Banner",
    "Ribbon Accent","Stamp Card","Magazine Cover","Neon Glow",
    "Vintage Poster","Chalkboard",
    "Social â€” Gradient","Social â€” Burst"
];

// ===== RENDER =====
function render() {
    const month = document.getElementById('monthName').value;
    const price = document.getElementById('promoPrice').value || '% OFF';
    const dealText = document.getElementById('dealDesc').value || 'Deal description here';
    const vendors = getVendors();
    const t = themeData[month];

    document.getElementById('themeBadge').textContent = t.label;
    const badge = document.getElementById('themeBadge');
    badge.style.background = t.badge;
    badge.style.color = t.badgeTxt;

    const locSelect = document.getElementById('locationSelect');
    const locOption = locSelect.options[locSelect.selectedIndex];
    const locText = locSelect.value === 'all' ? 'All Locations' : locOption.text;
    const locParts = locText.split(' â€” ');
    const locName = locParts[0];
    const locAddr = locParts[1] || 'All Green Lady Locations';

    const tplFont = document.getElementById('templateFont').value;

    const vendorHTML = vendors.map(v => {
        const fStyle = v.font ? `font-family:${v.font};` : '';
        const text = v.deal ? `${v.name} <span style="opacity:0.7;">â€” ${v.deal}</span>` : v.name;
        return v.font ? `<span style="${fStyle}">${text}</span>` : text;
    }).join('<br>');

    const grid = document.getElementById('templatesGrid');
    grid.innerHTML = '';

    const logo = 'green_lady_logo.svg';
    const tf = tplFont ? `font-family:${tplFont};` : '';
    const ci = customImageDataURL; // custom image data URL (empty string if none)
    const disclaimer = 'This product has intoxicating effects and may be habit forming. Marijuana can impair concentration, and judgement. Do not operate a vehicle or machinery under the influence of this drug. There may be health risks associated with consumption of this product. For use by adults 21+ and older. Keep out of reach of children.';
    // Custom image HTML snippets for different template placements
    const ciBlock = ci ? `<img src="${ci}" style="width:140px;height:100px;object-fit:cover;border-radius:8px;margin:8px 0;z-index:2;box-shadow:0 4px 15px rgba(0,0,0,0.15);">` : '';
    const ciBlockSmall = ci ? `<img src="${ci}" style="width:110px;height:80px;object-fit:cover;border-radius:6px;margin:6px 0;z-index:2;box-shadow:0 3px 10px rgba(0,0,0,0.15);">` : '';
    const ciBlockWide = ci ? `<img src="${ci}" style="width:80%;max-width:260px;height:90px;object-fit:cover;border-radius:6px;margin:8px 0;z-index:2;box-shadow:0 4px 15px rgba(0,0,0,0.15);">` : '';
    const ciBlockRound = ci ? `<img src="${ci}" style="width:90px;height:90px;object-fit:cover;border-radius:50%;margin:6px 0;z-index:2;box-shadow:0 4px 15px rgba(0,0,0,0.2);">` : '';
    const ciBlockGlow = ci ? `<img src="${ci}" style="width:130px;height:90px;object-fit:cover;border-radius:6px;margin:8px 0;z-index:2;box-shadow:0 0 20px ${t.c3}40;">` : '';

    const templates = [
        // 1 â€” Elegant Framed: centered, double border, ornate
        `<div style="width:100%;aspect-ratio:8.5/11;background:linear-gradient(180deg,${t.c5},${t.c4});position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:50px;overflow:hidden;">
            <div style="position:absolute;inset:14px;border:2px solid ${t.c2};pointer-events:none;"></div>
            <div style="position:absolute;inset:20px;border:1px solid ${t.c3};pointer-events:none;"></div>
            <div style="position:absolute;top:8px;font-size:1.6rem;z-index:1;">${t.emoji1}</div>
            <img src="${logo}" style="width:120px;height:auto;margin-bottom:14px;z-index:2;object-fit:contain;">
            <div style="font-family:'Dancing Script',cursive;font-size:1.2rem;color:${t.c2};z-index:2;">Vendor of the Month</div>
            <div style="font-family:'Playfair Display',serif;font-size:2.4rem;font-weight:900;color:${t.c1};margin:4px 0;z-index:2;">${month}</div>
            <div style="width:80px;height:2px;background:${t.c2};margin:6px 0;z-index:2;"></div>
            ${ciBlock}
            <div style="font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:700;color:${t.c2};text-align:center;margin:8px 0;line-height:1.6;z-index:2;">${vendorHTML}</div>
            <div style="font-size:0.8rem;color:${t.c1};text-align:center;line-height:1.6;max-width:260px;margin:6px 0;z-index:2;opacity:0.8;">${dealText}</div>
            <div style="background:${t.c1};color:#fff;padding:8px 32px;border-radius:30px;font-size:1.4rem;font-weight:700;margin-top:12px;z-index:2;">${price}</div>
            <div style="font-size:0.65rem;color:${t.c2};margin-top:10px;z-index:2;text-align:center;opacity:0.7;line-height:1.4;"><strong>${locName}</strong><br>${locAddr}</div>
            <div style="position:absolute;bottom:8px;font-size:1.4rem;z-index:1;">${t.emoji2}</div>
            <div style="position:absolute;bottom:24px;left:28px;right:28px;font-size:0.28rem;color:${t.c1};opacity:0.5;text-align:center;line-height:1.4;z-index:2;">${disclaimer}</div>
        </div>`,

        // 2 â€” Bold Split: top half color block, bottom half white
        `<div style="width:100%;aspect-ratio:8.5/11;position:relative;overflow:hidden;display:flex;flex-direction:column;">
            <div style="flex:1.2;background:linear-gradient(135deg,${t.c1},${t.c2});display:flex;flex-direction:column;align-items:center;justify-content:flex-end;padding:30px 30px 20px;position:relative;">
                <div style="position:absolute;top:12px;left:16px;font-size:1.4rem;">${t.emoji1}</div>
                <div style="position:absolute;top:0;right:0;width:150px;height:150px;border-radius:50%;background:rgba(255,255,255,0.06);"></div>
                <img src="${logo}" style="width:100px;height:auto;margin-bottom:10px;object-fit:contain;filter:brightness(0) invert(1);opacity:0.9;">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:3.2rem;color:#fff;line-height:1;text-shadow:0 3px 10px rgba(0,0,0,0.2);">${month.toUpperCase()}</div>
                <div style="font-size:0.7rem;letter-spacing:6px;text-transform:uppercase;color:rgba(255,255,255,0.7);">VENDOR OF THE MONTH</div>
            </div>
            <div style="flex:1;background:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px 30px;">
                ${ci ? `<img src="${ci}" style="width:140px;height:80px;object-fit:cover;border-radius:8px;margin-bottom:10px;box-shadow:0 4px 15px rgba(0,0,0,0.1);">` : ''}
                <div style="font-family:'Oswald',sans-serif;font-size:1.3rem;font-weight:700;color:${t.c1};text-align:center;line-height:1.5;letter-spacing:1px;">${vendorHTML}</div>
                <div style="width:40px;height:2px;background:${t.c3};margin:10px 0;"></div>
                <div style="font-size:0.78rem;color:#666;text-align:center;line-height:1.6;max-width:260px;">${dealText}</div>
                <div style="background:${t.c1};color:#fff;padding:10px 36px;font-family:'Bebas Neue',sans-serif;font-size:1.6rem;margin-top:14px;letter-spacing:2px;">${price}</div>
                <div style="font-size:0.65rem;color:#999;margin-top:10px;text-align:center;line-height:1.4;"><strong>${locName}</strong><br>${locAddr}</div>
                <div style="font-size:0.28rem;color:#999;text-align:center;line-height:1.4;margin-top:8px;padding:0 10px;">${disclaimer}</div>
            </div>
        </div>`,

        // 3 â€” Oversized Type: giant month as background, content overlaid
        `<div style="width:100%;aspect-ratio:8.5/11;background:${t.c5};position:relative;overflow:hidden;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:35px;">
            <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-55%);font-family:'Anton',sans-serif;font-size:8rem;color:${t.c4};line-height:1;text-transform:uppercase;white-space:nowrap;pointer-events:none;opacity:0.5;">${month.toUpperCase()}</div>
            <img src="${logo}" style="width:110px;height:auto;margin-bottom:10px;z-index:2;object-fit:contain;">
            <div style="font-size:0.7rem;letter-spacing:5px;text-transform:uppercase;color:${t.c2};z-index:2;">Vendor of the Month</div>
            <div style="font-family:'Abril Fatface',serif;font-size:2.8rem;color:${t.c1};margin:6px 0;z-index:2;">${month}</div>
            ${ciBlock}
            <div style="font-family:'Raleway',sans-serif;font-size:1.2rem;font-weight:700;color:${t.c2};text-align:center;line-height:1.6;z-index:2;margin:8px 0;">${vendorHTML}</div>
            <div style="font-size:0.78rem;color:${t.c1};text-align:center;line-height:1.5;max-width:240px;z-index:2;opacity:0.7;">${dealText}</div>
            <div style="background:${t.accent};color:#fff;padding:10px 34px;border-radius:4px;font-size:1.5rem;font-weight:900;margin-top:14px;z-index:2;font-family:'Montserrat',sans-serif;">${price}</div>
            <div style="font-size:0.6rem;color:${t.c2};margin-top:10px;z-index:2;text-align:center;opacity:0.6;line-height:1.4;"><strong>${locName}</strong><br>${locAddr}</div>
            <div style="position:absolute;bottom:10px;left:20px;right:20px;font-size:0.28rem;color:${t.c1};opacity:0.4;text-align:center;line-height:1.4;z-index:2;">${disclaimer}</div>
        </div>`,

        // 4 â€” Diagonal Banner: angled color stripe
        `<div style="width:100%;aspect-ratio:8.5/11;background:#fff;position:relative;overflow:hidden;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:35px;">
            <div style="position:absolute;top:-20%;left:-10%;width:120%;height:55%;background:linear-gradient(135deg,${t.c1},${t.c2});transform:rotate(-6deg);"></div>
            <div style="position:absolute;bottom:12px;right:16px;font-size:1.4rem;z-index:1;">${t.emoji2}</div>
            <div style="z-index:2;display:flex;flex-direction:column;align-items:center;margin-top:-40px;">
                <img src="${logo}" style="width:110px;height:auto;margin-bottom:10px;object-fit:contain;">
                <div style="font-family:'Oswald',sans-serif;font-size:0.7rem;letter-spacing:5px;text-transform:uppercase;color:rgba(255,255,255,0.8);">Vendor of the Month</div>
                <div style="font-family:'Playfair Display',serif;font-size:2.6rem;font-weight:900;color:#fff;margin:4px 0;text-shadow:0 2px 10px rgba(0,0,0,0.15);">${month}</div>
            </div>
            <div style="z-index:2;margin-top:30px;display:flex;flex-direction:column;align-items:center;">
                ${ciBlockWide}
                <div style="font-family:'Playfair Display',serif;font-size:1.3rem;font-weight:700;color:${t.c1};text-align:center;line-height:1.6;">${vendorHTML}</div>
                <div style="width:50px;height:2px;background:${t.c3};margin:10px 0;"></div>
                <div style="font-size:0.78rem;color:#666;text-align:center;line-height:1.6;max-width:260px;">${dealText}</div>
                <div style="border:3px solid ${t.c1};color:${t.c1};padding:8px 30px;font-size:1.4rem;font-weight:900;margin-top:14px;font-family:'Montserrat',sans-serif;">${price}</div>
                <div style="font-size:0.6rem;color:#999;margin-top:10px;text-align:center;line-height:1.4;"><strong>${locName}</strong><br>${locAddr}</div>
            </div>
            <div style="position:absolute;bottom:10px;left:20px;right:20px;font-size:0.28rem;color:#999;text-align:center;line-height:1.4;z-index:2;">${disclaimer}</div>
        </div>`,

        // 5 â€” Ribbon Accent: side ribbon + left-aligned text
        `<div style="width:100%;aspect-ratio:8.5/11;background:linear-gradient(180deg,${t.c5},#fff);position:relative;overflow:hidden;display:flex;flex-direction:column;justify-content:center;padding:40px 40px 40px 55px;">
            <div style="position:absolute;top:0;left:0;bottom:0;width:14px;background:linear-gradient(180deg,${t.c3},${t.c1});"></div>
            <div style="position:absolute;top:0;left:14px;bottom:0;width:4px;background:${t.c4};"></div>
            <div style="position:absolute;top:16px;right:20px;font-size:2rem;">${t.emoji1.split(' ')[0]}</div>
            <div style="position:absolute;bottom:16px;right:20px;font-size:2rem;">${t.emoji2.split(' ')[0]}</div>
            <img src="${logo}" style="width:110px;height:auto;margin-bottom:14px;object-fit:contain;">
            <div style="font-size:0.65rem;letter-spacing:7px;text-transform:uppercase;color:${t.c3};">VENDOR OF THE MONTH</div>
            <div style="font-family:'Playfair Display',serif;font-size:2.8rem;font-weight:900;color:${t.c1};margin:4px 0;line-height:1.1;">${month}</div>
            <div style="width:50px;height:3px;background:${t.c2};margin:12px 0;"></div>
            ${ci ? `<img src="${ci}" style="width:180px;height:100px;object-fit:cover;border-radius:8px;margin-bottom:10px;box-shadow:0 4px 15px rgba(0,0,0,0.1);">` : ''}
            <div style="font-family:'Montserrat',sans-serif;font-size:1rem;font-weight:300;color:${t.c2};letter-spacing:2px;text-transform:uppercase;line-height:1.8;">${vendorHTML}</div>
            <div style="font-size:0.78rem;color:#777;line-height:1.6;max-width:280px;margin-top:10px;">${dealText}</div>
            <div style="display:inline-block;border:2px solid ${t.c1};color:${t.c1};padding:8px 28px;font-size:1.4rem;font-weight:700;margin-top:16px;align-self:flex-start;">${price}</div>
            <div style="font-size:0.6rem;color:${t.c3};margin-top:12px;line-height:1.4;"><strong>${locName}</strong> â€” ${locAddr}</div>
            <div style="position:absolute;bottom:10px;left:55px;right:20px;font-size:0.28rem;color:${t.c1};opacity:0.4;text-align:left;line-height:1.4;z-index:2;">${disclaimer}</div>
        </div>`,

        // 6 â€” Stamp Card: dashed border, compact, rustic
        `<div style="width:100%;aspect-ratio:8.5/11;background:linear-gradient(180deg,${t.c4},${t.c3});position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center;padding:30px;">
            <div style="position:absolute;inset:12px;border:3px dashed rgba(255,255,255,0.35);pointer-events:none;"></div>
            <div style="background:rgba(255,255,255,0.15);backdrop-filter:blur(2px);border-radius:16px;padding:30px 24px;display:flex;flex-direction:column;align-items:center;max-width:88%;z-index:2;">
                <div style="font-size:1.8rem;margin-bottom:8px;">${t.emoji1.split(' ')[2]}</div>
                <img src="${logo}" style="width:110px;height:auto;margin-bottom:10px;object-fit:contain;">
                <div style="font-family:'Oswald',sans-serif;font-size:0.75rem;letter-spacing:4px;text-transform:uppercase;color:${t.c1};">VENDOR OF THE MONTH</div>
                <div style="font-family:'Lobster',cursive;font-size:2.4rem;color:${t.c1};margin:6px 0;">${month}</div>
                ${ciBlockRound}
                <div style="font-family:'Oswald',sans-serif;font-size:1.1rem;color:#fff;text-align:center;line-height:1.7;margin:6px 0;font-weight:600;">${vendorHTML}</div>
                <div style="font-size:0.78rem;color:${t.c1};text-align:center;line-height:1.5;max-width:230px;margin:6px 0;opacity:0.8;">${dealText}</div>
                <div style="background:${t.c1};color:#fff;padding:8px 30px;border-radius:6px;font-family:'Oswald',sans-serif;font-size:1.4rem;letter-spacing:2px;margin-top:10px;">${price}</div>
                <div style="font-size:0.6rem;color:${t.c1};margin-top:8px;text-align:center;opacity:0.7;line-height:1.4;"><strong>${locName}</strong><br>${locAddr}</div>
                <div style="font-size:0.26rem;color:${t.c1};opacity:0.5;text-align:center;line-height:1.4;margin-top:6px;padding:0 6px;">${disclaimer}</div>
            </div>
        </div>`,

        // 7 â€” Magazine Cover: full bleed gradient, large stacked text
        `<div style="width:100%;aspect-ratio:8.5/11;background:linear-gradient(160deg,${t.c1},${t.c2},${t.c3});position:relative;overflow:hidden;display:flex;flex-direction:column;justify-content:flex-end;padding:35px;">
            <div style="position:absolute;top:20px;left:24px;display:flex;align-items:center;gap:10px;z-index:2;">
                <img src="${logo}" style="width:80px;height:auto;object-fit:contain;filter:brightness(0) invert(1);opacity:0.9;">
                <div style="color:rgba(255,255,255,0.7);font-size:0.65rem;letter-spacing:4px;text-transform:uppercase;">Vendor of the Month</div>
            </div>
            <div style="position:absolute;top:16px;right:20px;font-size:1.4rem;">${t.emoji1.split(' ')[0]}</div>
            <div style="position:absolute;top:50%;right:-20px;transform:translateY(-50%) rotate(90deg);font-family:'Bebas Neue',sans-serif;font-size:4rem;color:rgba(255,255,255,0.06);white-space:nowrap;">VENDOR OF THE MONTH</div>
            ${ci ? `<div style="position:absolute;top:80px;right:30px;z-index:2;"><img src="${ci}" style="width:150px;height:120px;object-fit:cover;border-radius:10px;box-shadow:0 8px 30px rgba(0,0,0,0.3);"></div>` : ''}
            <div style="z-index:2;">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:4rem;color:#fff;line-height:0.95;text-shadow:0 4px 20px rgba(0,0,0,0.2);">${month.toUpperCase()}</div>
                <div style="font-family:'Raleway',sans-serif;font-size:1.2rem;font-weight:600;color:rgba(255,255,255,0.9);margin:10px 0;line-height:1.6;">${vendorHTML}</div>
                <div style="font-size:0.78rem;color:rgba(255,255,255,0.65);line-height:1.5;max-width:280px;margin:6px 0;">${dealText}</div>
                <div style="display:inline-block;background:#fff;color:${t.c1};padding:10px 34px;font-family:'Bebas Neue',sans-serif;font-size:1.8rem;margin-top:14px;letter-spacing:2px;">${price}</div>
                <div style="font-size:0.6rem;color:rgba(255,255,255,0.6);margin-top:10px;line-height:1.4;"><strong>${locName}</strong> â€” ${locAddr}</div>
            </div>
            <div style="position:absolute;bottom:10px;left:20px;right:20px;font-size:0.28rem;color:rgba(255,255,255,0.35);text-align:center;line-height:1.4;z-index:2;">${disclaimer}</div>
        </div>`,

        // 8 â€” Neon Glow: black background, glowing elements
        `<div style="width:100%;aspect-ratio:8.5/11;background:#0a0a0a;position:relative;overflow:hidden;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:35px;">
            <div style="position:absolute;inset:14px;border:1px solid ${t.c3};box-shadow:inset 0 0 40px ${t.c1}15,0 0 40px ${t.c1}10;pointer-events:none;"></div>
            <div style="position:absolute;top:-60px;left:-60px;width:200px;height:200px;border-radius:50%;background:radial-gradient(circle,${t.c1}15,transparent 70%);"></div>
            <div style="position:absolute;bottom:-60px;right:-60px;width:200px;height:200px;border-radius:50%;background:radial-gradient(circle,${t.accent}15,transparent 70%);"></div>
            <img src="${logo}" style="width:110px;height:auto;margin-bottom:12px;z-index:2;object-fit:contain;filter:brightness(0) invert(1);opacity:0.9;">
            <div style="font-family:'Oswald',sans-serif;font-size:0.65rem;letter-spacing:6px;text-transform:uppercase;color:${t.c3};z-index:2;text-shadow:0 0 10px ${t.c3}60;">VENDOR OF THE MONTH</div>
            <div style="font-family:'Bebas Neue',sans-serif;font-size:3.2rem;color:#fff;z-index:2;text-shadow:0 0 30px ${t.c3}40;margin:6px 0;">${month.toUpperCase()}</div>
            ${ciBlockGlow}
            <div style="font-family:'Oswald',sans-serif;font-size:1.1rem;color:${t.c3};text-align:center;line-height:1.6;z-index:2;text-shadow:0 0 8px ${t.c3}30;margin:6px 0;">${vendorHTML}</div>
            <div style="font-size:0.78rem;color:#777;text-align:center;line-height:1.6;max-width:250px;z-index:2;">${dealText}</div>
            <div style="border:2px solid ${t.c3};color:${t.c3};padding:8px 30px;font-size:1.4rem;font-weight:700;margin-top:14px;z-index:2;text-shadow:0 0 10px ${t.c3}50;font-family:'Bebas Neue',sans-serif;letter-spacing:3px;">${price}</div>
            <div style="font-size:0.55rem;color:#666;margin-top:10px;z-index:2;text-align:center;line-height:1.4;"><strong>${locName}</strong><br>${locAddr}</div>
            <div style="position:absolute;bottom:18px;left:20px;right:20px;font-size:0.28rem;color:rgba(255,255,255,0.3);text-align:center;line-height:1.4;z-index:2;">${disclaimer}</div>
        </div>`,

        // 9 â€” Vintage Poster: stacked horizontal bars
        `<div style="width:100%;aspect-ratio:8.5/11;background:${t.c5};position:relative;overflow:hidden;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:30px;gap:0;">
            <div style="position:absolute;top:0;left:0;right:0;height:6px;background:${t.c1};"></div>
            <div style="position:absolute;bottom:0;left:0;right:0;height:6px;background:${t.c1};"></div>
            <div style="font-size:1.6rem;margin-bottom:8px;">${t.emoji1}</div>
            <img src="${logo}" style="width:130px;height:auto;margin-bottom:4px;object-fit:contain;">
            <div style="background:${t.c2};color:#fff;padding:4px 50px;margin:4px 0;font-family:'Permanent Marker',cursive;font-size:1rem;">Vendor of the Month</div>
            <div style="font-family:'Anton',sans-serif;font-size:3rem;color:${t.c1};margin:8px 0;line-height:1;text-transform:uppercase;">${month.toUpperCase()}</div>
            ${ciBlockWide}
            <div style="background:${t.c3};padding:10px 30px;border-radius:4px;margin:6px 0;">
                <div style="font-family:'Oswald',sans-serif;font-size:1.1rem;color:#fff;text-align:center;line-height:1.6;font-weight:600;">${vendorHTML}</div>
            </div>
            <div style="font-size:0.78rem;color:${t.c1};text-align:center;line-height:1.6;max-width:260px;margin:8px 0;">${dealText}</div>
            <div style="background:${t.c1};color:#fff;padding:10px 40px;font-family:'Anton',sans-serif;font-size:1.8rem;letter-spacing:3px;">${price}</div>
            <div style="font-size:0.6rem;color:${t.c1};margin-top:8px;text-align:center;opacity:0.7;line-height:1.4;"><strong>${locName}</strong><br>${locAddr}</div>
            <div style="font-size:1.4rem;margin-top:4px;">${t.emoji2}</div>
            <div style="position:absolute;bottom:10px;left:20px;right:20px;font-size:0.28rem;color:${t.c1};opacity:0.4;text-align:center;line-height:1.4;z-index:2;">${disclaimer}</div>
        </div>`,

        // 10 â€” Chalkboard: dark textured bg, chalk style text
        `<div style="width:100%;aspect-ratio:8.5/11;background:${t.dark};position:relative;overflow:hidden;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;">
            <div style="position:absolute;inset:16px;border:2px solid rgba(255,255,255,0.15);pointer-events:none;"></div>
            <div style="position:absolute;inset:22px;border:1px solid rgba(255,255,255,0.08);pointer-events:none;"></div>
            <div style="font-size:1.6rem;margin-bottom:10px;opacity:0.7;">${t.emoji1}</div>
            <img src="${logo}" style="width:110px;height:auto;margin-bottom:10px;z-index:2;object-fit:contain;filter:brightness(0) invert(1);opacity:0.8;">
            <div style="font-family:'Dancing Script',cursive;font-size:1.2rem;color:${t.c4};z-index:2;">Vendor of the Month</div>
            <div style="font-family:'Playfair Display',serif;font-size:2.6rem;font-weight:900;color:#fff;z-index:2;margin:6px 0;">${month}</div>
            <div style="width:60px;height:1px;background:rgba(255,255,255,0.3);margin:8px 0;z-index:2;"></div>
            ${ci ? `<img src="${ci}" style="width:130px;height:90px;object-fit:cover;border-radius:8px;margin:6px 0;z-index:2;box-shadow:0 4px 20px rgba(0,0,0,0.4);border:2px solid rgba(255,255,255,0.1);">` : ''}
            <div style="font-family:'Dancing Script',cursive;font-size:1.3rem;color:${t.accent};text-align:center;line-height:1.6;z-index:2;margin:6px 0;">${vendorHTML}</div>
            <div style="font-size:0.78rem;color:rgba(255,255,255,0.5);text-align:center;line-height:1.6;max-width:250px;z-index:2;">${dealText}</div>
            <div style="border:2px solid ${t.accent};color:${t.accent};padding:8px 28px;font-size:1.3rem;font-weight:700;margin-top:12px;z-index:2;">${price}</div>
            <div style="font-size:0.55rem;color:rgba(255,255,255,0.4);margin-top:8px;z-index:2;text-align:center;line-height:1.4;"><strong>${locName}</strong><br>${locAddr}</div>
            <div style="font-size:1.2rem;margin-top:6px;opacity:0.6;">${t.emoji2}</div>
            <div style="position:absolute;bottom:20px;left:26px;right:26px;font-size:0.28rem;color:rgba(255,255,255,0.3);text-align:center;line-height:1.4;z-index:2;">${disclaimer}</div>
        </div>`,

        // 11 â€” Social Gradient
        `<div style="width:100%;aspect-ratio:1/1;background:linear-gradient(135deg,${t.c1},${t.c2},${t.c3});position:relative;overflow:hidden;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:30px;">
            <div style="position:absolute;top:-40px;right:-40px;width:160px;height:160px;border-radius:50%;background:rgba(255,255,255,0.06);"></div>
            <div style="position:absolute;bottom:-50px;left:-50px;width:180px;height:180px;border-radius:50%;background:rgba(255,255,255,0.04);"></div>
            <div style="font-size:1.4rem;margin-bottom:6px;z-index:2;">${t.emoji1}</div>
            <img src="${logo}" style="width:90px;height:auto;margin-bottom:8px;z-index:2;object-fit:contain;filter:brightness(0) invert(1);opacity:0.9;">
            <div style="font-size:0.6rem;letter-spacing:4px;text-transform:uppercase;color:rgba(255,255,255,0.7);z-index:2;">VENDOR OF THE MONTH</div>
            <div style="font-family:'Bebas Neue',sans-serif;font-size:2.4rem;color:#fff;z-index:2;margin:4px 0;">${month.toUpperCase()}</div>
            ${ciBlockSmall}
            <div style="font-size:1rem;font-weight:700;color:rgba(255,255,255,0.9);text-align:center;line-height:1.5;z-index:2;">${vendorHTML}</div>
            <div style="font-size:0.7rem;color:rgba(255,255,255,0.6);text-align:center;line-height:1.4;max-width:220px;margin:4px 0;z-index:2;">${dealText}</div>
            <div style="background:#fff;color:${t.c1};padding:6px 24px;border-radius:4px;font-size:1.2rem;font-weight:900;margin-top:8px;z-index:2;font-family:'Montserrat',sans-serif;">${price}</div>
            <div style="font-size:0.5rem;color:rgba(255,255,255,0.5);margin-top:6px;z-index:2;text-align:center;line-height:1.3;"><strong>${locName}</strong><br>Facebook & Instagram</div>
            <div style="position:absolute;bottom:8px;left:16px;right:16px;font-size:0.24rem;color:rgba(255,255,255,0.3);text-align:center;line-height:1.4;z-index:2;">${disclaimer}</div>
        </div>`,

        // 12 â€” Social Burst: centered circle composition
        `<div style="width:100%;aspect-ratio:1/1;background:${t.c5};position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center;padding:20px;">
            <div style="position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle at center,${t.c4}80,${t.c5} 70%);"></div>
            <div style="position:absolute;top:8px;font-size:1.3rem;z-index:1;">${t.emoji1}</div>
            <div style="position:absolute;bottom:8px;font-size:1.3rem;z-index:1;">${t.emoji2}</div>
            <div style="background:#fff;border-radius:50%;width:82%;aspect-ratio:1/1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px;box-shadow:0 10px 40px rgba(0,0,0,0.1);z-index:2;">
                <img src="${logo}" style="width:80px;height:auto;margin-bottom:6px;object-fit:contain;">
                <div style="font-family:'Dancing Script',cursive;font-size:0.9rem;color:${t.c2};">Vendor of the Month</div>
                <div style="font-family:'Playfair Display',serif;font-size:1.8rem;font-weight:900;color:${t.c1};margin:2px 0;">${month}</div>
                ${ci ? `<img src="${ci}" style="width:70px;height:70px;object-fit:cover;border-radius:50%;margin:4px 0;box-shadow:0 3px 10px rgba(0,0,0,0.15);">` : ''}
                <div style="font-size:0.9rem;font-weight:700;color:${t.c2};text-align:center;line-height:1.4;margin:4px 0;">${vendorHTML}</div>
                <div style="font-size:0.65rem;color:#888;text-align:center;line-height:1.4;max-width:180px;margin:2px 0;">${dealText}</div>
                <div style="background:${t.c1};color:#fff;padding:5px 20px;border-radius:20px;font-size:1rem;font-weight:700;margin-top:6px;">${price}</div>
                <div style="font-size:0.5rem;color:#999;margin-top:4px;text-align:center;">${locName}</div>
            </div>
            <div style="position:absolute;bottom:14px;font-size:0.55rem;color:${t.c3};z-index:3;">Facebook & Instagram</div>
            <div style="position:absolute;bottom:3px;left:14px;right:14px;font-size:0.22rem;color:${t.c2};opacity:0.4;text-align:center;line-height:1.4;z-index:3;">${disclaimer}</div>
        </div>`
    ];

    templates.forEach((html, i) => {
        grid.innerHTML += `
            <div class="template-wrapper">
                <h3>${i+1} â€” ${templateNames[i]}</h3>
                <div class="template-card">
                    <div class="select-badge">Click to print</div>
                    ${html}
                </div>
            </div>`;
    });

    // Apply global template font override if set
    if (tplFont) {
        grid.querySelectorAll('.template-card > div').forEach(flyer => {
            flyer.style.fontFamily = tplFont;
            flyer.querySelectorAll('div').forEach(el => {
                const s = el.getAttribute('style') || '';
                if (s.includes('font-family') && !el.querySelector('span[style*="font-family"]')) {
                    el.style.fontFamily = tplFont;
                }
            });
        });
    }

    // Click to open printable version
    grid.querySelectorAll('.template-card').forEach((card, i) => {
        card.onclick = () => openPrintView(card, i);
    });
}

function openPrintView(card, index) {
    const flyer = card.querySelector(':scope > div:last-child');
    if (!flyer) return;

    const isSocial = index >= 10;

    // Measure the card's actual rendered size
    const cardRect = flyer.getBoundingClientRect();
    const refW = Math.round(cardRect.width);
    const refH = Math.round(cardRect.height);

    const clone = flyer.cloneNode(true);

    // Make all image src absolute
    clone.querySelectorAll('img').forEach(img => {
        if (!img.src.startsWith('http') && !img.src.startsWith('data:')) {
            img.src = new URL(img.getAttribute('src'), window.location.href).href;
        }
    });

    // Lock clone to exact card size
    clone.style.width = refW + 'px';
    clone.style.height = refH + 'px';
    clone.style.aspectRatio = 'auto';
    clone.style.margin = '0';
    clone.style.flexShrink = '0';

    const fontsLink = "https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Montserrat:wght@300;400;600;700;900&family=Dancing+Script:wght@700&family=Bebas+Neue&family=Oswald:wght@400;600;700&family=Raleway:wght@300;400;600;700&family=Cormorant+Garamond:wght@400;600;700&family=Permanent+Marker&family=Anton&family=Abril+Fatface&family=Lobster&family=Poppins:wght@300;400;600;700&family=Lato:wght@300;400;700&family=Roboto+Slab:wght@400;700&family=Merriweather:wght@400;700&family=Pacifico&family=Sacramento&family=Great+Vibes&family=Righteous&family=Cinzel:wght@400;700;900&family=Archivo+Black&family=Josefin+Sans:wght@300;400;600;700&family=Caveat:wght@400;700&family=Satisfy&family=Comfortaa:wght@300;400;700&display=swap";

    const safeName = '${templateNames[index]}'.replace(/[^a-zA-Z0-9]/g, '_');

    const printHTML = `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Print â€” ${templateNames[index]}</title>
    <link rel="stylesheet" href="${fontsLink}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"><\/script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"><\/script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body {
            width: 100%;
            height: 100%;
            background: #f0f0f0;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
            font-family: 'Montserrat', sans-serif;
        }
        .toolbar {
            width: 100%;
            background: #1a1a2e;
            padding: 12px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
            z-index: 100;
            flex-wrap: wrap;
            gap: 10px;
        }
        .toolbar-title {
            color: #fff;
            font-size: 0.9rem;
            font-weight: 600;
        }
        .toolbar-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        .toolbar-group {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .toolbar-group label {
            color: rgba(255,255,255,0.6);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .toolbar select {
            padding: 8px 12px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: #fff;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            outline: none;
        }
        .toolbar select option { background: #1a1a2e; color: #fff; }
        .toolbar button {
            padding: 9px 20px;
            border: none;
            border-radius: 8px;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.15s;
        }
        .toolbar button:hover { transform: scale(1.03); }
        .btn-save {
            background: linear-gradient(135deg, #a855f7, #6366f1);
            color: #fff;
        }
        .btn-print {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: #1a1a2e;
        }
        .btn-back {
            background: rgba(255,255,255,0.1);
            color: #fff;
            border: 1px solid rgba(255,255,255,0.2) !important;
        }
        .orientation-toggle {
            display: flex;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.2);
        }
        .orientation-toggle button {
            padding: 8px 14px;
            border: none;
            border-radius: 0;
            background: rgba(255,255,255,0.05);
            color: rgba(255,255,255,0.5);
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .orientation-toggle button.active {
            background: rgba(255,255,255,0.2);
            color: #fff;
        }
        .orientation-toggle button:hover:not(.active) {
            background: rgba(255,255,255,0.1);
        }
        .print-container {
            flex: 1;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        /* The page-frame shows the paper â€” portrait or landscape */
        .page-frame {
            background: #fff;
            box-shadow: 0 10px 60px rgba(0,0,0,0.3);
            border-radius: 4px;
            overflow: visible;
            display: flex;
            align-items: center;
            justify-content: center;
            transform-origin: center center;
            transition: width 0.3s, height 0.3s;
        }
        .flyer-wrap {
            overflow: visible;
            width: ${refW}px;
            height: ${refH}px;
            flex-shrink: 0;
            transform-origin: center center;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        /* Saving overlay */
        .save-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            z-index: 9999;
            align-items: center;
            justify-content: center;
        }
        .save-overlay.active { display: flex; }
        .save-spinner {
            background: #1a1a2e;
            padding: 30px 50px;
            border-radius: 16px;
            color: #fff;
            font-size: 1rem;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
        }
        .save-spinner::after {
            content: '';
            display: block;
            width: 30px;
            height: 30px;
            margin: 14px auto 0;
            border: 3px solid rgba(255,255,255,0.2);
            border-top-color: #4facfe;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        @media print {
            .toolbar { display: none !important; }
            .save-overlay { display: none !important; }
            html, body {
                background: #fff !important;
                width: auto !important;
                height: auto !important;
                overflow: visible !important;
                display: block !important;
                margin: 0 !important;
                padding: 0 !important;
            }
            .print-container {
                padding: 0 !important;
                flex: none !important;
                display: block !important;
                overflow: visible !important;
                width: auto !important;
                height: auto !important;
            }
            .page-frame {
                box-shadow: none !important;
                border-radius: 0 !important;
                transition: none !important;
                width: auto !important;
                height: auto !important;
                overflow: visible !important;
                display: block !important;
            }
            .flyer-wrap {
                transform-origin: top left !important;
                overflow: visible !important;
            }
        }
    </style>
</head>
<body>
    <div class="toolbar">
        <span class="toolbar-title">${templateNames[index]}</span>
        <div class="toolbar-controls">
            <div class="toolbar-group">
                <label>Orientation</label>
                <div class="orientation-toggle">
                    <button id="btnPortrait" class="active" onclick="setOrientation('portrait')">Portrait</button>
                    <button id="btnLandscape" onclick="setOrientation('landscape')">Landscape</button>
                </div>
            </div>
            <div class="toolbar-group">
                <label>Format</label>
                <select id="saveFormat">
                    <option value="png">PNG</option>
                    <option value="jpg">JPG</option>
                    <option value="jpeg">JPEG</option>
                    <option value="gif">GIF</option>
                    <option value="webp">WebP</option>
                    <option value="pdf">PDF</option>
                </select>
            </div>
            <button class="btn-save" onclick="saveImage()">Save Image</button>
            <button class="btn-print" onclick="doPrint()">Print</button>
            <button class="btn-back" onclick="window.close()">Back</button>
        </div>
    </div>
    <div class="print-container">
        <div class="page-frame" id="pageFrame">
            <div class="flyer-wrap">
                ${clone.outerHTML}
            </div>
        </div>
    </div>
    <div class="save-overlay" id="saveOverlay">
        <div class="save-spinner">Generating image...</div>
    </div>

    <script>
        var REF_W = ${refW};
        var REF_H = ${refH};
        var IS_SOCIAL = ${isSocial};
        var currentOrientation = 'portrait';
        var TEMPLATE_NAME = '${templateNames[index].replace(/'/g, "\\'")}';

        function setOrientation(orient) {
            currentOrientation = orient;
            document.getElementById('btnPortrait').classList.toggle('active', orient === 'portrait');
            document.getElementById('btnLandscape').classList.toggle('active', orient === 'landscape');
            applyOrientation();
            scaleFlyer();
        }

        function applyOrientation() {
            var wrap = document.querySelector('.flyer-wrap');
            var inner = wrap ? wrap.querySelector(':scope > div') : null;
            if (!wrap || !inner) return;
            var isLandscape = currentOrientation === 'landscape' && !IS_SOCIAL;

            if (isLandscape) {
                /*
                 * Landscape: keep inner template at original portrait size,
                 * use uniform scale to fit within landscape container (no distortion).
                 * The portrait flyer scales down to fit the shorter landscape height,
                 * and is centered horizontally via flexbox on the wrap.
                 */
                var uniformScale = REF_W / REF_H; /* shrink to fit height */
                wrap.style.width = REF_H + 'px';
                wrap.style.height = REF_W + 'px';
                inner.style.width = REF_W + 'px';
                inner.style.height = REF_H + 'px';
                inner.style.aspectRatio = '8.5 / 11';
                inner.style.transform = 'scale(' + uniformScale + ')';
                inner.style.transformOrigin = 'center center';
            } else {
                /* Restore portrait */
                wrap.style.width = REF_W + 'px';
                wrap.style.height = REF_H + 'px';
                inner.style.width = REF_W + 'px';
                inner.style.height = REF_H + 'px';
                inner.style.aspectRatio = IS_SOCIAL ? '1 / 1' : '8.5 / 11';
                inner.style.transform = 'none';
                inner.style.transformOrigin = 'center center';
            }
        }

        function getCurW() {
            var isLandscape = currentOrientation === 'landscape' && !IS_SOCIAL;
            return isLandscape ? REF_H : REF_W;
        }
        function getCurH() {
            var isLandscape = currentOrientation === 'landscape' && !IS_SOCIAL;
            return isLandscape ? REF_W : REF_H;
        }

        function scaleFlyer() {
            var toolbar = document.querySelector('.toolbar');
            var frame = document.getElementById('pageFrame');
            var wrap = document.querySelector('.flyer-wrap');
            if (!frame || !wrap) return;

            var toolbarH = toolbar ? toolbar.offsetHeight : 0;
            var availW = window.innerWidth - 40;
            var availH = window.innerHeight - toolbarH - 40;
            var curW = getCurW();
            var curH = getCurH();
            var pageRatio = curW / curH;

            var pageW, pageH;
            if (availW / availH > pageRatio) {
                pageH = availH;
                pageW = pageH * pageRatio;
            } else {
                pageW = availW;
                pageH = pageW / pageRatio;
            }
            frame.style.width = pageW + 'px';
            frame.style.height = pageH + 'px';

            var flyerScale = Math.min(pageW / curW, pageH / curH);
            wrap.style.transform = 'scale(' + flyerScale + ')';
            wrap.style.transformOrigin = 'center center';
        }

        function doPrint() {
            var isLandscape = currentOrientation === 'landscape' && !IS_SOCIAL;

            var style = document.createElement('style');
            style.id = 'printPageStyle';

            if (isLandscape) {
                style.textContent = '@page { size: 11in 8.5in; margin: 0; }';
            } else {
                style.textContent = '@page { size: ' + (IS_SOCIAL ? '1080px 1080px' : '8.5in 11in') + '; margin: 0; }';
            }
            document.head.appendChild(style);

            var wrap = document.querySelector('.flyer-wrap');
            var inner = wrap ? wrap.querySelector(':scope > div') : null;
            var origWrapTransform = wrap.style.transform;

            /*
             * For print: scale the portrait flyer to fill the print page.
             * For portrait: scale to fit 816x1056 (letter at 96dpi).
             * For landscape: the inner stays portrait-sized with uniform scale;
             *   scale the whole wrap so the flyer fills the landscape page height.
             */
            if (isLandscape) {
                /* Landscape page: 1056w x 816h at 96dpi. Scale portrait flyer
                   to fit page height (816px), centered horizontally by flexbox. */
                var printScale = 816 / REF_H;
                wrap.style.width = '1056px';
                wrap.style.height = '816px';
                wrap.style.transform = 'none';
                /* Inner stays at portrait size; scale it to fit 816px tall */
                if (inner) {
                    inner.style.transform = 'scale(' + printScale + ')';
                    inner.style.transformOrigin = 'center center';
                }
            } else {
                var s = Math.min(816 / REF_W, 1056 / REF_H);
                wrap.style.transform = 'scale(' + s + ')';
                wrap.style.transformOrigin = 'top left';
            }

            window.print();

            setTimeout(function() {
                var ps = document.getElementById('printPageStyle');
                if (ps) ps.remove();
                wrap.style.transform = origWrapTransform;
                wrap.style.transformOrigin = 'center center';
                applyOrientation();
                scaleFlyer();
            }, 500);
        }

        function saveImage() {
            var fmt = document.getElementById('saveFormat').value;
            var overlay = document.getElementById('saveOverlay');
            overlay.classList.add('active');

            var wrap = document.querySelector('.flyer-wrap');
            var inner = wrap ? wrap.querySelector(':scope > div') : null;
            var origWrapTransform = wrap.style.transform;
            wrap.style.transform = 'none';

            var isLand = currentOrientation === 'landscape' && !IS_SOCIAL;
            var captureScale = 3;

            /*
             * Always capture the portrait flyer at its native size (REF_W x REF_H).
             * For landscape: temporarily remove inner scale so html2canvas gets
             * the clean portrait content, then we composite onto a landscape canvas.
             */
            var origInnerTransform;
            if (isLand && inner) {
                origInnerTransform = inner.style.transform;
                inner.style.transform = 'none';
            }

            setTimeout(function() {
                html2canvas(inner || wrap, {
                    scale: captureScale,
                    useCORS: true,
                    allowTaint: true,
                    backgroundColor: null,
                    width: REF_W,
                    height: REF_H
                }).then(function(portraitCanvas) {
                    wrap.style.transform = origWrapTransform;
                    if (isLand && inner) {
                        inner.style.transform = origInnerTransform;
                    }

                    var fileName = TEMPLATE_NAME.replace(/[^a-zA-Z0-9]/g, '_') + '_' + currentOrientation;
                    var outputCanvas = portraitCanvas;

                    if (isLand) {
                        /* Create landscape canvas, draw portrait flyer centered */
                        var landW = REF_H * captureScale;
                        var landH = REF_W * captureScale;
                        var lc = document.createElement('canvas');
                        lc.width = landW;
                        lc.height = landH;
                        var ctx = lc.getContext('2d');
                        /* Fill with white background */
                        ctx.fillStyle = '#ffffff';
                        ctx.fillRect(0, 0, landW, landH);
                        /* Scale portrait to fit landscape height, center horizontally */
                        var fitScale = landH / portraitCanvas.height;
                        var drawW = portraitCanvas.width * fitScale;
                        var drawH = landH;
                        var offsetX = (landW - drawW) / 2;
                        ctx.drawImage(portraitCanvas, offsetX, 0, drawW, drawH);
                        outputCanvas = lc;
                    }

                    if (fmt === 'pdf') {
                        var jsPDF = window.jspdf.jsPDF;
                        var doc;
                        if (IS_SOCIAL) {
                            doc = new jsPDF({ orientation: 'portrait', unit: 'in', format: [11, 11] });
                            doc.addImage(outputCanvas.toDataURL('image/png'), 'PNG', 0, 0, 11, 11);
                        } else if (isLand) {
                            doc = new jsPDF({ orientation: 'landscape', unit: 'in', format: 'letter' });
                            doc.addImage(outputCanvas.toDataURL('image/png'), 'PNG', 0, 0, 11, 8.5);
                        } else {
                            doc = new jsPDF({ orientation: 'portrait', unit: 'in', format: 'letter' });
                            doc.addImage(outputCanvas.toDataURL('image/png'), 'PNG', 0, 0, 8.5, 11);
                        }
                        doc.save(fileName + '.pdf');
                    } else {
                        var mimeTypes = {
                            png: 'image/png',
                            jpg: 'image/jpeg',
                            jpeg: 'image/jpeg',
                            gif: 'image/gif',
                            webp: 'image/webp'
                        };
                        var mime = mimeTypes[fmt] || 'image/png';
                        var quality = (fmt === 'jpg' || fmt === 'jpeg') ? 0.95 : undefined;

                        outputCanvas.toBlob(function(blob) {
                            var url = URL.createObjectURL(blob);
                            var a = document.createElement('a');
                            a.href = url;
                            a.download = fileName + '.' + fmt;
                            document.body.appendChild(a);
                            a.click();
                            document.body.removeChild(a);
                            URL.revokeObjectURL(url);
                        }, mime, quality);
                    }

                    overlay.classList.remove('active');
                }).catch(function(err) {
                    wrap.style.transform = origWrapTransform;
                    if (isLand && inner) {
                        inner.style.transform = origInnerTransform;
                    }
                    overlay.classList.remove('active');
                    alert('Error generating image: ' + err.message);
                });
            }, 100);
        }

        window.addEventListener('resize', scaleFlyer);
        window.addEventListener('load', scaleFlyer);
        scaleFlyer();
    <\/script>
</body>
</html>`;

    const printWindow = window.open('', '_blank');
    printWindow.document.write(printHTML);
    printWindow.document.close();
}

// ===== VENDORS =====
const fontOptions = [
    { val: "", label: "Auto" },
    { val: "'Playfair Display', serif", label: "Playfair Display" },
    { val: "'Montserrat', sans-serif", label: "Montserrat" },
    { val: "'Oswald', sans-serif", label: "Oswald" },
    { val: "'Bebas Neue', sans-serif", label: "Bebas Neue" },
    { val: "'Raleway', sans-serif", label: "Raleway" },
    { val: "'Poppins', sans-serif", label: "Poppins" },
    { val: "'Lato', sans-serif", label: "Lato" },
    { val: "'Josefin Sans', sans-serif", label: "Josefin Sans" },
    { val: "'Comfortaa', sans-serif", label: "Comfortaa" },
    { val: "'Anton', sans-serif", label: "Anton" },
    { val: "'Archivo Black', sans-serif", label: "Archivo Black" },
    { val: "'Righteous', sans-serif", label: "Righteous" },
    { val: "'Roboto Slab', serif", label: "Roboto Slab" },
    { val: "'Merriweather', serif", label: "Merriweather" },
    { val: "'Cinzel', serif", label: "Cinzel" },
    { val: "'Cormorant Garamond', serif", label: "Cormorant Garamond" },
    { val: "'Abril Fatface', serif", label: "Abril Fatface" },
    { val: "'Dancing Script', cursive", label: "Dancing Script" },
    { val: "'Lobster', cursive", label: "Lobster" },
    { val: "'Pacifico', cursive", label: "Pacifico" },
    { val: "'Sacramento', cursive", label: "Sacramento" },
    { val: "'Great Vibes', cursive", label: "Great Vibes" },
    { val: "'Caveat', cursive", label: "Caveat" },
    { val: "'Satisfy', cursive", label: "Satisfy" },
    { val: "'Permanent Marker', cursive", label: "Permanent Marker" }
];

function buildFontSelect() {
    return fontOptions.map(f => `<option value="${f.val}">${f.label}</option>`).join('');
}

// Populate the initial vendor font dropdown
document.querySelector('.vendor-font-input').innerHTML = buildFontSelect();

function addVendor() {
    const row = document.createElement('div');
    row.className = 'vendor-row';
    row.innerHTML = `
        <div class="control-group"><label>Vendor Name</label><input type="text" class="vendor-name-input" value="" placeholder="Vendor name"></div>
        <div class="control-group"><label>Vendor Deal (optional)</label><input type="text" class="vendor-deal-input" value="" placeholder="Their specialty"></div>
        <div class="control-group"><label>Vendor Font</label><select class="vendor-font-input">${buildFontSelect()}</select></div>
        <button class="btn-remove" onclick="removeVendor(this)">âœ•</button>`;
    document.getElementById('vendorRows').appendChild(row);
    row.querySelectorAll('input, select').forEach(i => i.addEventListener('input', render));
    row.querySelectorAll('select').forEach(i => i.addEventListener('change', render));
}

function removeVendor(btn) {
    if (document.querySelectorAll('.vendor-row').length > 1) {
        btn.closest('.vendor-row').remove();
        render();
    }
}

function getVendors() {
    const names = document.querySelectorAll('.vendor-name-input');
    const deals = document.querySelectorAll('.vendor-deal-input');
    const fonts = document.querySelectorAll('.vendor-font-input');
    const v = [];
    names.forEach((input, i) => {
        const name = input.value.trim();
        const deal = deals[i] ? deals[i].value.trim() : '';
        const font = fonts[i] ? fonts[i].value : '';
        if (name) v.push({ name, deal, font });
    });
    return v.length ? v : [{ name: 'Vendor Name', deal: '', font: '' }];
}

function updateTemplates() { render(); }

// Init
render();
document.querySelectorAll('.controls input, .controls select').forEach(el => {
    el.addEventListener('input', render);
    el.addEventListener('change', render);
});
</script>

</body>
</html>
